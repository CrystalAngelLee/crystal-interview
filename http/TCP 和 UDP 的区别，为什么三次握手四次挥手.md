# TCP和UDP的区别

> TCP（Transmission Control Protocol，传输控制协议）是基于连接的协议，也就是说，在正式收发数据前，必须和对方建立可靠的连接。一个TCP连接必须要经过三次“对话”才能建立起来
>
> UDP（User Data Protocol，用户数据报协议）是与TCP相对应的协议。它是面向非连接的协议，它不与对方建立连接，而是直接就把数据包发送过去！
>
> UDP适用于一次只传送少量数据、对可靠性要求不高的应用环境。

1. TCP面向连接，UDP是无连接的    
2. TCP在开始数据传输之前要经过三次握手，UDP却不需要任何准备即可进行数据传输，因此UDP不会引入建立连接的时延    
3. TCP提供可靠的服务，UDP尽最大努力交付，即不保证可靠交付
   TCP传输数据具有重传机制，如果在传输数据的过程中发生丢包事件，发送方会重传丢失的分组，所以TCP保证发送的分组一定能到达接收方，因此是可靠的。
   UDP在应用层得到数据后，附加上用于多路复用/多路分解服务的源端口号和目的端口号字段后，直接将形成的报文段传输给网络，而网络层是不可靠的，因而不能保证数据传输的可靠性。（可以在应用层实现UDP数据传输的可靠性）    
4. UDP具有较好的实时性，工作效率比TCP高
   UDP在传输数据前不需要建立连接，没有繁琐的握手过程，没有复杂的拥塞控制算法和重传机制，所以UDP相对于TCP具有较高的效率。    
5. 每一条TCP连接只能是点到点，UDP支持一对一、一对多、多对多    
6. TCP对系统资源要求较多，UDP对系统资源要求较少
   TCP建立连接后，会为连接分配发送缓存和接受缓存，维护拥塞控制变量以及序号和确认号的参数，因此需要占用较多的系统资源。而UDP是无连接的，对系统资源要求较少

![image-20210820182959477](/Users/crystalangel/Library/Application Support/typora-user-images/image-20210820182959477.png)

# 为什么三次握手四次挥手

因为当Server端接收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文使用来应答的，SYN报文是用来同步的。

当关闭连接时，当Server端接受到FIN报文时，很可能并不会立刻关闭SOCKET，所以只是先回复一个ACK报文，告知Client端，Client发送的FIN报文已经接收。只有等Server端所有的报文都发送完了，才会发送FIN报文，所以不能同时发送ACK+FIN报文，故需要四次挥手
